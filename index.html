<html><head><title>ropes</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Howard Perrin" /><meta name="description" content="Type-level String Formats" /><meta name="og:image" content="/ropes/img/poster.png" /><meta name="image" property="og:image" content="/ropes/img/poster.png" /><meta name="og:title" content="ropes" /><meta name="title" property="og:title" content="ropes" /><meta name="og:site_name" content="ropes" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Type-level String Formats" /><link rel="icon" type="image/png" href="/ropes/img/favicon.png" /><meta name="twitter:title" content="ropes" /><meta name="twitter:image" content="/ropes/img/poster.png" /><meta name="twitter:description" content="Type-level String Formats" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/ropes/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/ropes/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/ropes/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/ropes/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/ropes/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/ropes/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/ropes/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/ropes/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/ropes/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/ropes/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/ropes/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/ropes/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/ropes/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/ropes/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/ropes/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/ropes/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/ropes/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/ropes/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/ropes/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/ropes/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/ropes/highlight/styles/default.css" /><link rel="stylesheet" href="/ropes/css/style.css" /><link rel="stylesheet" href="/ropes/css/palette.css" /><link rel="stylesheet" href="/ropes/css/codemirror.css" /></head><body><header id="site-header"><div class="navbar-wrapper"><div class="container"><div class="row"><div class="col-xs-6"><a href="/ropes/" class="brand"><div class="icon-wrapper"><span>ropes</span></div></a></div><div class="col-xs-6"><nav class="text-right"><ul class=""><li><a href="https://github.com/howyp/ropes"><i class="fa fa-github"></i><span class="hidden-xs">GitHub</span></a></li></ul></nav></div></div></div></div><div class="jumbotron"><div class="container"><h1 class="text-center">Type-level String Formats</h1><h2></h2><p class="text-center"><a href="https://github.com/howyp/ropes" class="btn btn-outline-inverse">View on GitHub</a></p></div></div><div><ul class="horizontalNav">      </ul></div></header><main id="site-main"><section class="use"><div class="container"><div id="content"><h4 id="type-level-string-formats">Type-level String Formats</h4>

<p>Declare your string formats at the type level, and
get parsers, writers, composition and generators for free.</p>

<h3 id="introduction">Introduction</h3>

<p>Everyone has come across code before that is <em>string</em>ly typed - where
there are strong types for data structures, but fields that we know
<strong>must</strong> match a certain format are represented simply as <code class="highlighter-rouge">String</code>s.
Things like email addresses, host names, post codes, user/product IDs
etc. And often we don’t just need to validate the formats, but to be
able to decompose and use specific parts of them</p>

<p>So, the aim of Ropes is to give a general way to define such
strongly-typed strings, and give many useful ways to work with them.</p>

<h3 id="principles">Principles</h3>

<p><em>The type of a <code class="highlighter-rouge">Rope</code> completely expresses the definition of what values
are valid.</em></p>

<p>Every valid <code class="highlighter-rouge">Rope</code> can be:</p>
<ul>
  <li><strong>Parsed</strong> safely from a <code class="highlighter-rouge">String</code></li>
  <li><strong>Written</strong> precisely back to a <code class="highlighter-rouge">String</code></li>
  <li><strong>Decomposed</strong> into its constituent parts</li>
  <li><strong>Composed</strong> with other <code class="highlighter-rouge">Rope</code>s to form a new ones</li>
  <li><strong>Generated</strong> through arbitrary values which always adhere to the
definition</li>
</ul>

<h3 id="current-status">Current Status</h3>

<p>At the moment, this is very much an alpha. Although lots of effort has
been made to ensure good testing, the API may be subject to breaking and
radical changes.</p>

<p>Also, because it supports
<a href="https://docs.scala-lang.org/sips/42.type.html">literal types</a>, for the
moment we only support Scala 2.13, but it should be possible to also
build against Scala 2.12 in the future.</p>

<h3 id="inspirations">Inspirations</h3>

<p>Frank Thomas’s <strong>excellent</strong>
<a href="https://github.com/fthomas/refined">refined</a> library provides a way to enforce
restrictions on a wide range of value and collection types in Scala,
including <code class="highlighter-rouge">String</code>s. It does this through predicates, which give
great power to the user to define any refinement they choose.</p>

<p>However, because of this power, it is also problematic to provide the
ability to decompose a refined <code class="highlighter-rouge">String</code> based on the given predicate,
and is also not generally possible to generate arbitrary values matching
predicates.</p>

<h1 id="getting-started">Getting Started</h1>

<p>Let’s dive straight into some examples.</p>

<h3 id="a-basic-rope-twitter-handles">A Basic Rope: Twitter Handles</h3>

<p>We know that (simplistically) a Twitter handle always starts with a
literal ‘@’ symbol, followed by any string. We can define that with:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">ropes.core._</span>

<span class="k">type</span> <span class="kt">TwitterHandle</span> <span class="o">=</span> <span class="nc">Concat</span><span class="o">[</span><span class="kt">Literal</span><span class="o">[</span><span class="kt">'@'</span><span class="o">]</span>, <span class="kt">AnyString</span><span class="o">]</span>
</code></pre>
</div>

<p>Or you can use Concat as an infix type:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">type</span> <span class="kt">TwitterHandle</span> <span class="o">=</span> <span class="nc">Literal</span><span class="o">[</span><span class="kt">'@'</span><span class="o">]</span> <span class="nc">Concat</span> <span class="nc">AnyString</span>
</code></pre>
</div>

<p>Now, we can parse matching strings, and write them back to their
original form:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="nc">Rope</span><span class="o">.</span><span class="n">parseTo</span><span class="o">[</span><span class="kt">TwitterHandle</span><span class="o">](</span><span class="s">"!Bob"</span><span class="o">)</span>
<span class="c1">// res0: Either[ropes.core.Rope.InvalidValue.type,TwitterHandle] = Left(InvalidValue)
</span>
<span class="k">val</span> <span class="nc">Right</span><span class="o">(</span><span class="n">howy</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Rope</span><span class="o">.</span><span class="n">parseTo</span><span class="o">[</span><span class="kt">TwitterHandle</span><span class="o">](</span><span class="s">"@HowyP"</span><span class="o">)</span>
<span class="c1">// howy: TwitterHandle = Concat(Literal(@),AnyString(HowyP))
</span>
<span class="n">howy</span><span class="o">.</span><span class="n">write</span>
<span class="c1">// res1: String = @HowyP
</span></code></pre>
</div>

<h4 id="composing-and-decomposing">Composing and decomposing</h4>

<p>After parsing, we can access the parts of the rope based on the
properties of each individual type. In this case, they are pretty basic.
A <code class="highlighter-rouge">Concat</code> has a prefix and suffix, and the <code class="highlighter-rouge">Literal</code> and <code class="highlighter-rouge">AnyString</code>
contain single values:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">howy</span><span class="o">.</span><span class="n">prefix</span>
<span class="c1">// res2: ropes.core.Literal['@'] = Literal(@)
</span>
<span class="n">howy</span><span class="o">.</span><span class="n">prefix</span><span class="o">.</span><span class="n">value</span>
<span class="c1">// res3: Char = @
</span>
<span class="n">howy</span><span class="o">.</span><span class="n">suffix</span>
<span class="c1">// res4: ropes.core.AnyString = AnyString(HowyP)
</span>
<span class="n">howy</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">value</span>
<span class="c1">// res5: String = HowyP
</span></code></pre>
</div>

<p>We can also create new handles from scratch, or modify existing ones:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="n">twitter</span><span class="k">:</span> <span class="kt">TwitterHandle</span> <span class="o">=</span> <span class="nc">Concat</span><span class="o">(</span><span class="nc">Literal</span><span class="o">(</span><span class="sc">'@'</span><span class="o">),</span> <span class="nc">AnyString</span><span class="o">(</span><span class="s">"Twitter"</span><span class="o">))</span>
<span class="c1">// twitter: TwitterHandle = Concat(Literal(@),AnyString(Twitter))
</span>
<span class="k">val</span> <span class="n">bob</span><span class="k">:</span> <span class="kt">TwitterHandle</span>     <span class="o">=</span> <span class="n">howy</span><span class="o">.</span><span class="n">copy</span><span class="o">(</span><span class="n">suffix</span> <span class="k">=</span> <span class="nc">AnyString</span><span class="o">(</span><span class="s">"Bob"</span><span class="o">))</span>
<span class="c1">// bob: TwitterHandle = Concat(Literal(@),AnyString(Bob))
</span></code></pre>
</div>

<h4 id="generating">Generating</h4>

<p>Lastly, a feature of all <code class="highlighter-rouge">Rope</code>s is that they can be generated via
Scalacheck <code class="highlighter-rouge">Arbitrary</code>:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">org.scalacheck.Arbitrary.arbitrary</span>
<span class="c1">// import org.scalacheck.Arbitrary.arbitrary
</span>
<span class="k">import</span> <span class="nn">ropes.scalacheck._</span>
<span class="c1">// import ropes.scalacheck._
</span>
<span class="nc">List</span><span class="o">.</span><span class="n">fill</span><span class="o">(</span><span class="mi">5</span><span class="o">)(</span><span class="n">arbitrary</span><span class="o">[</span><span class="kt">TwitterHandle</span><span class="o">].</span><span class="n">sample</span><span class="o">).</span><span class="n">flatten</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">write</span> <span class="o">+</span> <span class="sc">'\n'</span><span class="o">)</span>
<span class="c1">// res6: List[String] =
// List("@꺏஦눪괐贁࣫ጫ捅騮ݒᰐ탉ɰ郯੽鑡뚩딱ᜣꚅ왐᯿ꃸ⠺⌴ຂί龵蒛诅跑粂㑾疌屍Ꞥ뻑ᄟꇩ㎡启髖뷛塩⧙挞◮㙦ዿꄊ⍤ˋ䷎ˑ㭀嗘럸ʫ
// ", "@셠ﻈ体晩杭卐꜅欝怎乿鷕䰈嵃윾繘砯洆הּ扑䥥ꩩ?﷾꘎藎뫁槦䏨ꀣ㋷镘㖚⭢⋴鐯䣝ﻻ葃ᤘ粅㺮㦝ấ茊➷⮏אּ榊葲軻婯ᑷꍹ㷖柱塕⇎ꌆ썿蠨耳镆뮅頂택躣면渼䍱ꙛﻷ牍ហ壋䗞쌇裒ꭘ卌瀌㏼艷ڱᖔ텐➶ᾆ㡞㏪ꅇ勵㴗
// ", "@蟩䷼㖓槬㙃㊤뎬㈂ᑜ蓁所䌐
// ", "@䢣ꡛ贈灮ㄤ龿懾⣺쳌鏥஦慌⼲ꃬ湃包흄뭠令儧흋柋㠏▏욯絮⼺쭲譌귬좮䄗⪟焯殒烼覇譜궒ꆪ婲㒇늴鞐̫軄ใ鬕땩鎀謹ፀ㯛ᥥ鮾鵋튳녎䲚
// ", "@
// ")
</span></code></pre>
</div>

<h4 id="restricting-with-repeated-and-letter">Restricting with <code class="highlighter-rouge">Repeated</code> and <code class="highlighter-rouge">Letter</code></h4>

<p>But wait! Those handles don’t look very realistic. Only 15 letters are
allowed for the username portion of the handle. Let’s update our
specification:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">type</span> <span class="kt">Username</span>      <span class="o">=</span> <span class="nc">Repeated</span><span class="o">[</span><span class="err">1</span>, <span class="err">15</span>, <span class="kt">Letter</span><span class="o">]</span>
<span class="k">type</span> <span class="kt">TwitterHandle</span> <span class="o">=</span> <span class="nc">Literal</span><span class="o">[</span><span class="kt">'@'</span><span class="o">]</span> <span class="nc">Concat</span> <span class="nc">Username</span>
</code></pre>
</div>

<p>Being more precise, we’ve stated that the <code class="highlighter-rouge">Username</code> must consist of
letter characters, repeated 1 to 15 times. It now will not allow
usernames which are too long or have non-letter characters:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="nc">Rope</span><span class="o">.</span><span class="n">parseTo</span><span class="o">[</span><span class="kt">TwitterHandle</span><span class="o">](</span><span class="s">"@HowyP"</span><span class="o">)</span>
<span class="c1">// res7: Either[ropes.core.Rope.InvalidValue.type,TwitterHandle] = Right(Concat(Literal(@),Repeated(List(First(Range(H)), Second(Range(o)), Second(Range(w)), Second(Range(y)), First(Range(P))))))
</span>
<span class="nc">Rope</span><span class="o">.</span><span class="n">parseTo</span><span class="o">[</span><span class="kt">TwitterHandle</span><span class="o">](</span><span class="s">"@TwoManyCharactersForAUsername"</span><span class="o">)</span>
<span class="c1">// res8: Either[ropes.core.Rope.InvalidValue.type,TwitterHandle] = Left(InvalidValue)
</span>
<span class="nc">Rope</span><span class="o">.</span><span class="n">parseTo</span><span class="o">[</span><span class="kt">TwitterHandle</span><span class="o">](</span><span class="s">"@foo&amp;bar"</span><span class="o">)</span>
<span class="c1">// res9: Either[ropes.core.Rope.InvalidValue.type,TwitterHandle] = Left(InvalidValue)
</span></code></pre>
</div>

<p>Now, let’s try generating some handles again:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="nc">List</span><span class="o">.</span><span class="n">fill</span><span class="o">(</span><span class="mi">5</span><span class="o">)(</span><span class="n">arbitrary</span><span class="o">[</span><span class="kt">TwitterHandle</span><span class="o">].</span><span class="n">sample</span><span class="o">).</span><span class="n">flatten</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">write</span> <span class="o">+</span> <span class="sc">'\n'</span><span class="o">)</span>
<span class="c1">// res10: List[String] =
// List("@DsPEfVsAIQEZB
// ", "@ZzZLdIHt
// ", "@E
// ", "@uVQdoykCjZwnBpj
// ", "@KGWCqHfOWQyyMVP
// ")
</span></code></pre>
</div>

<h4 id="defining-character-sets-with-range">Defining character sets with <code class="highlighter-rouge">Range</code></h4>

<p><code class="highlighter-rouge">Letter</code> comes pre-defined in ropes as:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">type</span> <span class="kt">Letter</span> <span class="o">=</span> <span class="nc">Letter</span><span class="o">.</span><span class="nc">Uppercase</span> <span class="nc">Or</span> <span class="nc">Letter</span><span class="o">.</span><span class="nc">Lowercase</span>
<span class="k">object</span> <span class="nc">Letter</span> <span class="o">{</span>
    <span class="k">type</span> <span class="kt">Uppercase</span> <span class="o">=</span> <span class="nc">Range</span><span class="o">[</span><span class="kt">'A'</span>, <span class="kt">'Z'</span><span class="o">]</span>
    <span class="k">type</span> <span class="kt">Lowercase</span> <span class="o">=</span> <span class="nc">Range</span><span class="o">[</span><span class="kt">'a'</span>, <span class="kt">'z'</span><span class="o">]</span>
<span class="o">}</span>
</code></pre>
</div>

<p>It defines the upper and lower case characters using a <code class="highlighter-rouge">Range</code>, which
takes two literal type parameters specifying the minimum and maximum
characters allowed. <code class="highlighter-rouge">Or</code> lets us to join the two, allowing characters
from either range.</p>

<h3 id="a-tougher-rope-social-security-numbers">A Tougher Rope: Social Security Numbers</h3>

<p>According to
<a href="https://en.wikipedia.org/wiki/Social_Security_number#Structure">Wikipedia</a>
a US Social Security number is:</p>

<blockquote>
  <p>a nine-digit number in the format “AAA-GG-SSSS”. The number is divided 
into three parts: the first three
digits, known as the area number because they were formerly assigned by
geographical region; the middle two digits, known as the group number;
and the final four digits, known as the serial number.</p>
</blockquote>

<p>So let’s build that as a <code class="highlighter-rouge">Rope</code>:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">type</span> <span class="kt">Area</span>   <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">3</span>, <span class="kt">Digit</span><span class="o">]</span>
<span class="k">type</span> <span class="kt">Group</span>  <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">2</span>, <span class="kt">Digit</span><span class="o">]</span>
<span class="k">type</span> <span class="kt">Serial</span> <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">4</span>, <span class="kt">Digit</span><span class="o">]</span>
<span class="k">type</span> <span class="kt">Dash</span>   <span class="o">=</span> <span class="nc">Literal</span><span class="o">[</span><span class="kt">'-'</span><span class="o">]</span>
<span class="k">type</span> <span class="kt">SSN</span>    <span class="o">=</span> <span class="nc">Concat</span><span class="o">[</span><span class="kt">Area</span>, <span class="kt">Concat</span><span class="o">[</span><span class="kt">Dash</span>, <span class="kt">Concat</span><span class="o">[</span><span class="kt">Group</span>, <span class="kt">Concat</span><span class="o">[</span><span class="kt">Dash</span>, <span class="kt">Serial</span><span class="o">]]]]</span>
</code></pre>
</div>

<p>We’re using two new types here. <code class="highlighter-rouge">Digit</code> defines a numeric character 
between 0 and 9. <code class="highlighter-rouge">Repeated.Exactly[N, R]</code> specifies that we expect <code class="highlighter-rouge">N</code> 
instances of the rope <code class="highlighter-rouge">R</code>.</p>

<h4 id="working-with-nested-concats">Working with nested <code class="highlighter-rouge">Concat</code>s</h4>

<p>The definition for <code class="highlighter-rouge">SSN</code> we have so far isn’t very easy to read because
of all the nesting. We can make it simpler by using the <code class="highlighter-rouge">+:</code> syntax from
the DSL:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">ropes.dsl._</span>
<span class="k">type</span> <span class="kt">SSN</span> <span class="o">=</span> <span class="nc">Area</span> <span class="o">+:</span> <span class="nc">Dash</span> <span class="o">+:</span> <span class="nc">Group</span> <span class="o">+:</span> <span class="nc">Dash</span> <span class="o">+:</span> <span class="nc">Serial</span>
</code></pre>
</div>
<h4 id="using-section">Using <code class="highlighter-rouge">section</code></h4>

<p>We can parse and access parts of the SSN in the same way as for the
twitter handle:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">val</span> <span class="nc">Right</span><span class="o">(</span><span class="n">parsed</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Rope</span><span class="o">.</span><span class="n">parseTo</span><span class="o">[</span><span class="kt">SSN</span><span class="o">](</span><span class="s">"078-05-1120"</span><span class="o">)</span>
<span class="c1">// parsed: SSN = Concat(Repeated(List(ConvertedTo(0), ConvertedTo(7), ConvertedTo(8))),Concat(Literal(-),Concat(Repeated(List(ConvertedTo(0), ConvertedTo(5))),Concat(Literal(-),Repeated(List(ConvertedTo(1), ConvertedTo(1), ConvertedTo(2), ConvertedTo(0)))))))
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">prefix</span><span class="o">.</span><span class="n">write</span>
<span class="c1">// res11: String = 078
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">prefix</span><span class="o">.</span><span class="n">write</span>
<span class="c1">// res12: String = 05
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">write</span>
<span class="c1">// res13: String = 1120
</span></code></pre>
</div>

<p>but it is clumsy to navigate through all of the prefixes and suffixes.
Instead, we can use the <code class="highlighter-rouge">section</code> method to access a given section by
index:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">1</span><span class="o">].</span><span class="n">write</span>
<span class="c1">// res14: String = 078
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">3</span><span class="o">].</span><span class="n">write</span>
<span class="c1">// res15: String = 05
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">5</span><span class="o">].</span><span class="n">write</span>
<span class="c1">// res16: String = 1120
</span></code></pre>
</div>

<h4 id="naming-sections-with-named">Naming sections with <code class="highlighter-rouge">Named</code></h4>

<p>If we’d like, we can also access sections by giving them a name:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">type</span> <span class="kt">Area</span>   <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">3</span>, <span class="kt">Digit</span><span class="o">]</span> <span class="nc">Named</span> <span class="s">"Area"</span>
<span class="k">type</span> <span class="kt">Group</span>  <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">2</span>, <span class="kt">Digit</span><span class="o">]</span> <span class="nc">Named</span> <span class="s">"Group"</span>
<span class="k">type</span> <span class="kt">Serial</span> <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">4</span>, <span class="kt">Digit</span><span class="o">]</span> <span class="nc">Named</span> <span class="s">"Serial"</span>
</code></pre>
</div>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">"</span><span class="kt">Area</span><span class="err">"</span><span class="o">].</span><span class="n">write</span>
<span class="c1">// res17: String = 078
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">"</span><span class="kt">Group</span><span class="err">"</span><span class="o">].</span><span class="n">write</span>
<span class="c1">// res18: String = 05
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">"</span><span class="kt">Serial</span><span class="err">"</span><span class="o">].</span><span class="n">write</span>
<span class="c1">// res19: String = 1120
</span></code></pre>
</div>

<h4 id="representing-sections-as-ints-with-convertedto">Representing sections as <code class="highlighter-rouge">Int</code>s with <code class="highlighter-rouge">ConvertedTo</code></h4>

<p>When we’ve accessed the area, group and serial numbers above, we’ve used
<code class="highlighter-rouge">.write</code> to returned them as <code class="highlighter-rouge">String</code>s. That’s because the actual return
type is <code class="highlighter-rouge">Repeated.Exactly[N, Digit]</code>, which gives it’s values as a list
of <code class="highlighter-rouge">Int</code>s. That’s a bit difficult to work with, and they’d be more
naturally represented as <code class="highlighter-rouge">Int</code>s.</p>

<p>Ropes provides a way to do this using <code class="highlighter-rouge">ConvertedTo</code>, which takes a rope
type and the type you want to convert to and from:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">type</span> <span class="kt">Area</span>   <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">3</span>, <span class="kt">Digit</span><span class="o">]</span> <span class="nc">ConvertedTo</span> <span class="nc">Int</span> <span class="nc">Named</span> <span class="s">"Area"</span>
<span class="k">type</span> <span class="kt">Group</span>  <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">2</span>, <span class="kt">Digit</span><span class="o">]</span> <span class="nc">ConvertedTo</span> <span class="nc">Int</span> <span class="nc">Named</span> <span class="s">"Group"</span>
<span class="k">type</span> <span class="kt">Serial</span> <span class="o">=</span> <span class="nc">Repeated</span><span class="o">.</span><span class="nc">Exactly</span><span class="o">[</span><span class="err">4</span>, <span class="kt">Digit</span><span class="o">]</span> <span class="nc">ConvertedTo</span> <span class="nc">Int</span> <span class="nc">Named</span> <span class="s">"Serial"</span>
</code></pre>
</div>

<p>We can now use <code class="highlighter-rouge">.value</code> on each section and get a simple <code class="highlighter-rouge">Int</code>:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">"</span><span class="kt">Area</span><span class="err">"</span><span class="o">].</span><span class="n">value</span>
<span class="c1">// res20: Int = 78
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">"</span><span class="kt">Group</span><span class="err">"</span><span class="o">].</span><span class="n">value</span>
<span class="c1">// res21: Int = 5
</span>
<span class="n">parsed</span><span class="o">.</span><span class="n">section</span><span class="o">[</span><span class="err">"</span><span class="kt">Serial</span><span class="err">"</span><span class="o">].</span><span class="n">value</span>
<span class="c1">// res22: Int = 1120
</span></code></pre>
</div>

<!--- Explain `Conversion` --->

<!--- What about setting sections? --->
</div></div></section><section class="technologies"><div class="container"><div class="row"></div></div></section></main><footer id="site-footer"><div class="container"><div class="row"><div class="col-xs-6"><p>ropes is designed and developed by <a href="" target="_blank">Howard Perrin</a></p></div><div class="col-xs-6"><p class="text-right"><a href="https://github.com/howyp/ropes"><span class="fa fa-github"></span>View on GitHub</a></p></div></div><div class="row"><div class="col-xs-6"><p>Website built with <a href="https://47deg.github.io/sbt-microsites/" target="_blank">Sbt-microsites</a> - © 2016 <a href="https://www.47deg.com/" target="_blank">47 Degrees</a></p></div></div></div></footer></body></html>